<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>優香の 一問一答（精神分析×文学 英単語）</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
      max-width: 800px;
      margin: 24px auto;
      padding: 0 16px 40px;
      line-height: 1.6;
    }
    h1 {
      font-size: 22px;
      margin-bottom: 4px;
    }
    h2 {
      font-size: 18px;
      margin-top: 24px;
      border-bottom: 1px solid #ccc;
      padding-bottom: 4px;
    }
    .subtitle {
      color: #555;
      font-size: 13px;
      margin-bottom: 16px;
    }
    .card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 16px;
      margin: 12px 0;
      background: #fafafa;
    }
    .label {
      font-size: 12px;
      color: #777;
    }
    .question {
      font-size: 24px;
      font-weight: 600;
      margin: 8px 0 4px;
    }
    .meaning {
      font-size: 18px;
      margin-top: 8px;
    }
    .reading {
      font-size: 14px;
      color: #555;
    }
    .note {
      font-size: 13px;
      color: #666;
      margin-top: 4px;
    }
    button {
      border-radius: 999px;
      border: 1px solid #ccc;
      padding: 6px 14px;
      margin: 4px 4px 4px 0;
      font-size: 13px;
      cursor: pointer;
      background: white;
    }
    button.primary {
      background: #222;
      color: white;
      border-color: #222;
    }
    button.good {
      background: #1a7f37;
      color: white;
      border-color: #1a7f37;
    }
    button.bad {
      background: #b91c1c;
      color: white;
      border-color: #b91c1c;
    }
    button:disabled {
      opacity: 0.5;
      cursor: default;
    }
    .small {
      font-size: 12px;
      color: #777;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 12px;
    }
    th, td {
      border-bottom: 1px solid #eee;
      padding: 4px 2px;
      text-align: left;
    }
    th {
      font-weight: 600;
      font-size: 11px;
      color: #555;
    }
    .center {
      text-align: center;
    }
    .tag {
      display: inline-block;
      font-size: 10px;
      padding: 1px 6px;
      border-radius: 999px;
      background: #eee;
      margin-left: 4px;
      color: #555;
    }
  </style>
</head>
<body>
  <h1>一問一答：精神分析×文学 英単語</h1>
  <div class="subtitle">
    ・英語 → 日本語／カタカナ読みのクイズ<br>
    ・「次の問題」でランダム出題、「答えを見る → 正解/不正解」で記録されます。<br>
    ・成績はブラウザに保存されます（同じPC・同じブラウザなら残る）。
  </div>

  <h2>問題</h2>
  <div class="card" id="quiz-card">
    <div class="label">問題（英語）</div>
    <div class="question" id="question-word">—</div>
    <div class="small" id="question-index">—</div>

    <div id="answer-area" style="display:none; margin-top: 8px;">
      <div class="label">意味</div>
      <div class="meaning" id="answer-meaning">—</div>
      <div class="reading" id="answer-reading"></div>
      <div class="note" id="answer-note"></div>
      <div class="small" id="answer-stats"></div>
    </div>

    <div style="margin-top: 12px;">
      <button class="primary" id="next-btn">次の問題</button>
      <button id="show-btn">答えを見る</button>
      <button class="good" id="correct-btn" disabled>正解</button>
      <button class="bad" id="wrong-btn" disabled>不正解</button>
    </div>
  </div>

  <h2>単語一覧（成績）</h2>
  <div class="small">※正解数・挑戦数は自動更新されます。</div>
  <div id="table-container"></div>

  <script>
    // 優香専用：精神分析×文学 単語カード
    const cards = [
      {
        id: 1,
        en: "destruction",
        jp: "破壊",
        kana: "デストラクション",
        note: "精神分析では攻撃性・欲動（死の欲動）の表現として扱われる。"
      },
      {
        id: 2,
        en: "transition",
        jp: "移行・変化",
        kana: "トランジション",
        note: "破壊→変化→救い／再生という流れの「変化」の部分を説明するときに使える。"
      },
      {
        id: 3,
        en: "rebirth",
        jp: "再生（よみがえり）",
        kana: "リバース",
        note: "文学・神話などでの『死と再生』モチーフに頻出。"
      },
      {
        id: 4,
        en: "regeneration",
        jp: "再生・再構築",
        kana: "リジェネレーション",
        note: "心の再統合・やり直しのプロセスを表すときに使いやすい語。"
      },
      {
        id: 5,
        en: "trauma",
        jp: "心的外傷・トラウマ",
        kana: "トラウマ",
        note: "外傷体験や喪失が心に残した傷。再生の物語とセットで語られやすい。"
      },
      {
        id: 6,
        en: "unconscious",
        jp: "無意識",
        kana: "アンコンシャス",
        note: "フロイトの基本概念。自覚されない心の領域。"
      },
      {
        id: 7,
        en: "repression",
        jp: "抑圧",
        kana: "リプレッション",
        note: "耐えがたい感情や欲望を無意識に追いやる防衛機制。"
      },
      {
        id: 8,
        en: "projection",
        jp: "投影",
        kana: "プロジェクション",
        note: "自分の感情や衝動を、他者が持っているように感じてしまう防衛機制。"
      },
      {
        id: 9,
        en: "introjection",
        jp: "取り入れ",
        kana: "イントロジェクション",
        note: "他者像を内面に取り込み、自己の一部として保持する働き。"
      },
      {
        id: 10,
        en: "splitting",
        jp: "分裂（善悪の分け方）",
        kana: "スプリッティング",
        note: "対象を『全部良い／全部悪い』と極端に分けてしまう防衛機制。"
      },
      {
        id: 11,
        en: "attachment",
        jp: "愛着",
        kana: "アタッチメント",
        note: "人との結びつき・依存・見捨てられ不安などを扱うときの基礎概念。"
      },
      {
        id: 12,
        en: "dependency",
        jp: "依存",
        kana: "ディペンデンシー",
        note: "対象への過度な依存／しがみつきの状態を説明する語。"
      },
      {
        id: 13,
        en: "aggression",
        jp: "攻撃性",
        kana: "アグレッション",
        note: "破壊衝動や怒りのエネルギーを論じるときに使われる。"
      },
      {
        id: 14,
        en: "drive",
        jp: "欲動",
        kana: "ドライブ",
        note: "フロイトの欲動概念（生の欲動／死の欲動）一般を指す。"
      },
      {
        id: 15,
        en: "death drive",
        jp: "死の欲動",
        kana: "デスドライブ",
        note: "自己破壊・無への回帰を志向する心の傾向。"
      },
      {
        id: 16,
        en: "symbolic",
        jp: "象徴的な",
        kana: "シンボリック",
        note: "ラカンなどで重要な『象徴界』に関わる形容詞。"
      },
      {
        id: 17,
        en: "representation",
        jp: "表象",
        kana: "レプレゼンテーション",
        note: "心が経験をどのように『イメージ・物語・記号』として持つかを示す概念。"
      },
      {
        id: 18,
        en: "narrative",
        jp: "物語・語り",
        kana: "ナラティヴ",
        note: "痛みやトラウマを『語る』こと、ナラティヴ・メディスンとも関連。"
      },
      {
        id: 19,
        en: "identity",
        jp: "自己性・同一性",
        kana: "アイデンティティ",
        note: "『自分とは何か』という問いと、その一貫性・揺れを扱う。"
      },
      {
        id: 20,
        en: "anxiety",
        jp: "不安",
        kana: "アングザイエティ",
        note: "精神分析で基本となる情動。恐怖とは少し違う概念。"
      }
    ];

    // ---- 成績の保存／読み込み ----
    const STORAGE_KEY = "yuka_eitan_quiz_stats_v1";

    function loadStats() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return {};
        return JSON.parse(raw);
      } catch (e) {
        return {};
      }
    }

    function saveStats(stats) {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(stats));
      } catch (e) {
        console.warn("保存に失敗しました", e);
      }
    }

    let stats = loadStats(); // { [id]: {correct, total} }

    function getCardStats(id) {
      if (!stats[id]) stats[id] = { correct: 0, total: 0 };
      return stats[id];
    }

    // ---- 出題ロジック ----
    let currentCard = null;
    let answered = false;

    const qWordEl = document.getElementById("question-word");
    const qIndexEl = document.getElementById("question-index");
    const ansAreaEl = document.getElementById("answer-area");
    const ansMeaningEl = document.getElementById("answer-meaning");
    const ansReadingEl = document.getElementById("answer-reading");
    const ansNoteEl = document.getElementById("answer-note");
    const ansStatsEl = document.getElementById("answer-stats");

    const nextBtn = document.getElementById("next-btn");
    const showBtn = document.getElementById("show-btn");
    const correctBtn = document.getElementById("correct-btn");
    const wrongBtn = document.getElementById("wrong-btn");

    function pickRandomCard() {
      // 苦手なカードをやや優先したい場合はここで重みづけもできる
      const idx = Math.floor(Math.random() * cards.length);
      return cards[idx];
    }

    function refreshTable() {
      const container = document.getElementById("table-container");
      let html = "<table><thead><tr><th>英語</th><th>意味</th><th class='center'>正解</th><th class='center'>挑戦</th><th class='center'>正解率</th></tr></thead><tbody>";
      cards.forEach(card => {
        const s = getCardStats(card.id);
        const rate = s.total > 0 ? Math.round((s.correct / s.total) * 100) + "%" : "—";
        html += `<tr>
          <td>${card.en}</td>
          <td>${card.jp}</td>
          <td class="center">${s.correct}</td>
          <td class="center">${s.total}</td>
          <td class="center">${rate}</td>
        </tr>`;
      });
      html += "</tbody></table>";
      container.innerHTML = html;
    }

    function showNewQuestion() {
      currentCard = pickRandomCard();
      answered = false;
      qWordEl.textContent = currentCard.en;
      const index = cards.findIndex(c => c.id === currentCard.id) + 1;
      qIndexEl.textContent = `No.${index} / 全${cards.length}語`;

      ansAreaEl.style.display = "none";
      ansMeaningEl.textContent = "";
      ansReadingEl.textContent = "";
      ansNoteEl.textContent = "";
      ansStatsEl.textContent = "";

      showBtn.disabled = false;
      correctBtn.disabled = true;
      wrongBtn.disabled = true;
    }

    function showAnswer() {
      if (!currentCard) return;
      const s = getCardStats(currentCard.id);
      ansMeaningEl.textContent = currentCard.jp;
      ansReadingEl.textContent = `読み：${currentCard.kana}`;
      ansNoteEl.textContent = currentCard.note;
      const rate = s.total > 0 ? Math.round((s.correct / s.total) * 100) + "%" : "—";
      ansStatsEl.textContent = `これまでの成績：正解 ${s.correct} / 挑戦 ${s.total}（正解率 ${rate}）`;
      ansAreaEl.style.display = "block";
      showBtn.disabled = true;
      correctBtn.disabled = false;
      wrongBtn.disabled = false;
    }

    function recordAnswer(isCorrect) {
      if (!currentCard) return;
      const s = getCardStats(currentCard.id);
      s.total += 1;
      if (isCorrect) s.correct += 1;
      saveStats(stats);
      refreshTable();
      correctBtn.disabled = true;
      wrongBtn.disabled = true;
    }

    nextBtn.addEventListener("click", showNewQuestion);
    showBtn.addEventListener("click", showAnswer);
    correctBtn.addEventListener("click", () => recordAnswer(true));
    wrongBtn.addEventListener("click", () => recordAnswer(false));

    // 初期表示
    refreshTable();
    showNewQuestion();
  </script>
</body>
</html>
