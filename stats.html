<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>成績一覧：精神分析×文学 英単語</title>
  <link rel="stylesheet" href="./ui/css/base.css">
</head>
<body>
  <a href="index.html" class="home-link">← トップページに戻る</a>
  <h1>成績一覧：精神分析×文学 英単語</h1>
  <div class="small">
    ・クイズ画面で解いた結果がここに反映されます。<br>
    ・ブラウザのローカルデータを利用しているため、別の端末・ブラウザでは共有されません。<br>
  </div>

  <div id="table-container" class="small">読み込み中…</div>

  <button onclick="location.href='index.html'">クイズ画面にもどる</button>

  <script>
    const CARDS_KEY = "yuka_eitan_quiz_cards_v1";
    const STATS_KEY = "yuka_eitan_quiz_stats_v1";

    function loadCards() {
      try {
        const raw = localStorage.getItem(CARDS_KEY);
        if (!raw) return [];
        return JSON.parse(raw);
      } catch (e) {
        return [];
      }
    }

    function loadStats() {
      try {
        const raw = localStorage.getItem(STATS_KEY);
        if (!raw) return {};
        return JSON.parse(raw);
      } catch (e) {
        return {};
      }
    }

    function renderTable() {
      const container = document.getElementById("table-container");
      const cards = loadCards();
      const stats = loadStats();

      if (!cards.length) {
        container.textContent = "まだクイズ画面を開いていないか、単語データがありません。";
        return;
      }

      let html = "<table><thead><tr>" +
        "<th>英語</th><th>意味</th>" +
        "<th class='center'>正解</th><th class='center'>挑戦</th><th class='center'>正解率</th>" +
        "</tr></thead><tbody>";

      cards.forEach(card => {
        const s = stats[card.id] || { correct: 0, total: 0 };
        const rate = s.total > 0 ? Math.round((s.correct / s.total) * 100) + "%" : "—";
        html += `<tr>
          <td>${card.en}</td>
          <td>${card.jp}</td>
          <td class="center">${s.correct}</td>
          <td class="center">${s.total}</td>
          <td class="center">${rate}</td>
        </tr>`;
      });

      html += "</tbody></table>";
      container.innerHTML = html;
    }

    renderTable();
  </script>
</body>
</html>
